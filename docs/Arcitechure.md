# Архитектура

## Термины
`Правило` - шаблонная структура данных, содержащая данные, которые должны присутствовать в пакете для принятия решения о его блокировке.

## Принцип работы модуля ядра
Модуль ядра на уровне NF_IP_PRE_ROUTING смотрит все проходящие пакеты и сравнивает каждый пакет с `правилом`. Еслив результате сравнения `правило` содержится в пакете, то пакет отбрасывается.
Статистика по пакетам записывается в `/proc/mynetmod/drop_stats`

## Команды

### ioctl - ADD_RULE
Передаёт в модуль правило, которое нухно добавить в список правил.

### ioctl - DEL_RULE
Передаёт в модуль правило, которое нужно удалить из списка правил.

### SHOW
Читвет статичтику из `/proc/mynetmod/drop_stats`  и выводит её пользователю.

## Команды приложения userspace
1. `--ipsrc` - установка ip адреса источника в пакете
2. `--ipdst` - установка ip адреса получателя в пакете
3. `--transport` - установка протокола указанного в пакете
4. `--portsrc` - указывает порт отправителя 
5. `--portdst` - указывает порт получателя
5. `--show` - показывает статистику по правилам.
6. `--filter` - с параметром `enable` добавляет правило в фильтр, с параметром `disable` удаляет правило из фильтра
