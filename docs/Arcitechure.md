# Архитектура

## Принцип работы модуля ядра
есть бесконечный цикл (потом уточнить как реализовать фильтр) и он выполняет фильтрацию входящего и исходящего трафика. Каждый пакет он проверяет на соответсвие одному из правил (Всего их 10).
Ядро постоянно ведёт статистику по всем исполняемым файлам, при удалении правила ядро вместе с сообщением об удалении правила выводит статистику этого правила.

## Команды приложения userspace
1. `--ipsrc` - установка ip адреса источника в пакете
2. `--ipdst` - установка ip адреса получателя в пакете
3. `--transport` - установка протокола указанного в пакете
4. `--portsrc` - указывает порт отправителя 
5. `--portdst` - указывает порт получателя
5. `--show` - показывает статистику по правилам.
6. `--filter` - с параметром `enable` добавляет правило в фильтр, с параметром `disable` удаляет правило из фильтра

### `--show`
Данный параметр принимает след. параметры:
1. rule - показать статистику по правилам (или правилу, если другими утилитами установлен шаблон правила)
2. stats - статистику по всем пакетам. Кол-во обработанных пакетов, заблокированных, суммарно всего сколько пакетов было.

## Структура правила
``` C

```

## Cписок команд ioctl
1. ADDRULE 			- добавляить правило и включить фильтр по этому правилу
2. DELRULE 			- выключить фильтр по этому правилу и удаляить правило
// 3. ONRULE		- включает фильтр по этому правилу
// 4. OFFRULE		- выключает фильтр по этому правилу
// 5. ENABLEFILTER 	- включает фильтр по всем правилам
6. DISABLEFILTER 	- выключает фильтр по всем правилам
7. SHOW_STATISTIK	- выдача статистики по всем правилам
8. CHECK_RULES		- показывает все *существующие* правила с их статусом (фильтр выполняет его или нет)

## Алгоритмы функций

### kern: `uint8_t is_need_to_drop(struct iphdr *orig_iph, struct tcphdr *orig_tcph, struct udphdr *orig_udph)`
Значить так ..

## Баги

### Возможно

### Широковещательная рассылка

Будет ли блокироваться широковещательный трафик